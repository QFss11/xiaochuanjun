<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="./js/jquery-3.3.1.min.js"></script>
    <style>
        *{
            margin: 0;
            padding: 0;
        }
        img{
            width: 50px;
            height: 50px;
            /* 图文混排时，让文字参考图片垂直的位置排版 */
            vertical-align: middle;
        }
        .num{
            width: 30px;
        }
		table{
			text-align: center;
		}
		
    </style>
</head>
<body>
	
    <table border="1" style="width: 100%">
        <tr>
            <th>商品名称</th>
            <th>状态</th>
            <th>商品数量</th>
            <th>单价</th>
            <th>小计</th>
            <th>操作</th>
        </tr>
        <tr class="shop-item">
            <td>
                <img src="./image/xmNOTE2-80.jpg" alt="">
                 EC MIX 旗舰机
            </td>
            <td>可购买</td>
            <td>
                <input type="button" value="-" class="decount">
                <input type="text" name="disabled" value="1" class="num">
                <input type="button" value="+" class="add">
            </td>
            <td>3499</td>
            <td></td>
            <td><a href="#" class="del">删除商品</a></td>
        </tr>
        <tr class="shop-item">
            <td>
                <img src="./image/xm6_80.png" alt="">
                 小米8青春版
            </td>
            <td>可购买</td>
            <td>
                <input type="button" value="-" class="decount">
                <input type="text" name="disabled" value="1" class="num">
                <input type="button" value="+" class="add">
            </td>
            <td>1059</td>
            <td></td>
            <td><a href="#" class="del">删除商品</a></td>
        </tr>
        <tr class="shop-item">
            <td>
                <img src="./image/xm5S-80.jpg" alt="">
                 小米10青春版
            </td>
            <td>可购买</td>
            <td>
                <input type="button" value="-" class="decount">
                <input type="text" name="disabled" value="1" class="num">
                <input type="button" value="+" class="add">
            </td>
            <td>1829</td>
            <td></td>
            <td><a href="#" class="del">删除商品</a></td>
        </tr>

      
        <tr>
            <td></td>
            <td></td>
            <td></td>
            <td>商品<span id="nums">0</span>件</td>
            <td>应付金额<span id="sums">0</span>元</td>
            <td><input type="button" value="结算" class="jiesuan"></td>
        </tr>
    </table>
    <script>
      
        $(".del").click(function(){
            if(confirm("是否删除该商品"))
            {
            $(this).parent().parent().remove();
            shopsum();
            }
          
        });
       
        var sums = 0;
        shopsum();
        function shopsum(){
         var nums = 0;
        
        //初始化时，求解商品的价格*数量，显示到小计中
        $(".shop-item").each(function(index){
            //对应每个商品的索引为index 这个
            var shopNum = $(".num").eq(index).val();
            var price = $(".num").eq(index).parent().next("td").text();
            var sum = shopNum * price;
            $(".num").eq(index).parent().next("td").next("td").text(sum.toFixed(2));
            nums+=parseInt(shopNum);
            sums+=sum;
        });
        $("#nums").text(nums);
        $("#sums").text(sums.toFixed(2));
        }


        $(".jiesuan").click(function(){
           if(confirm("你需要支付"+sums.toFixed(2)+"元"))
           {
                 alert("结算成功");
                 $("table").remove();
                 document.write("已无商品结算");
           }
        });

        //通过类名获取，可以获取多个标签的意思
        $(".add").click(function(){
            //1.获取它当前这个商品的数量
            var shopNum = $(this).prev("input").val();
            //prev() 获取相邻的前一个标签 next() 获取相邻的下一个标签
            //2.点击一次，商品数量累加 1
            shopNum++;
            $(this).prev("input").val(shopNum);

            countshopsum($(this),shopNum);
        });
        $(".decount").click(function(){
            var shopNum = $(this).next("input").val();
            if(shopNum>1)
            {
                shopNum--;
            }
            $(this).next("input").val(shopNum);
           countshopsum($(this),shopNum);
        });
        function countshopsum(obj,shopNum)
        {   
            //4获取商品单价
            var price = obj.parent().next("td").text();
            //求和
            var sum = shopNum * price;
            //赋值到指定的框中
            obj.parent().next("td").next("td").text(sum.toFixed(2));
            shopsum();

         
        }
      
     
    </script>
</body>
</html>